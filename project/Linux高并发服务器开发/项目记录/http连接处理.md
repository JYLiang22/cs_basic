- [基础知识](#基础知识)
  - [epoll](#epoll)
  - [HTTP报文格式](#http报文格式)
    - [请求报文](#请求报文)
    - [响应报文](#响应报文)
  - [HTTP状态码](#http状态码)
  - [有限状态机](#有限状态机)
  - [http处理流程](#http处理流程)
    - [http报文处理流程](#http报文处理流程)
    - [http类](#http类)
    - [epoll相关代码](#epoll相关代码)
    - [服务器接收http请求](#服务器接收http请求)
- [请求报文解析](#请求报文解析)
  - [流程图和状态机](#流程图和状态机)
  - [代码分析-http报文解析](#代码分析-http报文解析)
    - [HTTP\_CODE含义](#http_code含义)
    - [解析报文整体流程](#解析报文整体流程)
- [请求报文响应](#请求报文响应)


# 基础知识


## epoll
介绍了epoll_create、epoll_ctl、epoll_wait三个函数，不多赘述<br>
介绍了select、poll、epoll和ET、LT，看小林文章，不多赘述<br>


## HTTP报文格式


### 请求报文
请求报文有两种，GET和POST，这两个不太一样，但都是由这四部分组成的： **请求行（request line）、请求头部（header）、空行和请求数据**
1. 请求行：用来说明请求类型，要访问的资源以及所使用的HTTP版本
2. 请求头部：紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息
   1. HOST，给出请求资源所在服务器的域名
   2. User-Agent，HTTP客户端程序的信息，该信息由你发出请求使用的浏览器来定义，并且在每个请求中自动发送等
   3. Accept，说明用户代理可处理的媒体类型
   4. Accept-Encoding，说明用户代理支持的内容编码
   5. Accept-Language，说明用户代理能够处理的自然语言集
   6. Content-Type，说明实现主体的媒体类型
   7. Content-Length，说明实现主体的大小
   8. Connection，连接管理，可以是 **Keep-Alive或close** ，参考文章(https://xiaolincoding.com/network/3_tcp/tcp_http_keepalive.html)
3. 空行， **请求头部后面的空行是必须的** 即使第四部分的请求数据为空，也必须有空行
4. 请求数据也叫主体，可以添加任意的其他数据


### 响应报文
也是四个部分组成： **状态行、消息报头、空行和响应正文**
1. 状态行，由HTTP协议版本号， 状态码， 状态消息 三部分组成
2. 消息报头，用来说明客户端要使用的一些附加信息，例如生成响应的日期和时间、编码类型等等
3. 空行，消息报头后面的空行是必须的
4. 响应正文，服务器返回给客户端的文本信息。空行后面的html部分为响应正文


## HTTP状态码
这里主要讲了5大类，又细说了8小类，这里就不详细介绍了，可以参考博客。


## 有限状态机
这里目前也没有过多感悟，感觉就是利用if-else  switch-case语句进行状态判断和跳转


## http处理流程


### http报文处理流程
概述：浏览器端发出http连接请求，主线程创建http对象接收请求并将所有数据读入对应buffer，将该对象插入任务队列，工作线程从任务队列中取出一个任务进行处理<br>
下面主要解析三类代码


### http类
先介绍、定义了各种属性，感觉还是要结合下面的代码去理解这些属性的意义，否则的话理解起来很难。<br>


### epoll相关代码
这个代码还是比较简单，只要弄清楚epoll原理和搞清楚相关库函数，都是不难理解的。


### 服务器接收http请求
概述：浏览器端发出http连接请求，主线程创建http对象接收请求并将所有数据读入对应buffer，将该对象插入任务队列，工作线程从任务队列中取出一个任务进行处理


# 请求报文解析
概述：工作线程取出任务后，调用process_read函数，通过主、从状态机对请求报文进行解析。所以将结合流程图和代码分别对状态机和服务器解析请求报文进行详解。<br>


## 流程图和状态机
没读懂这里的主状态机和从状态机，为什么要搞出这两个东西，反正就是不太懂。<br>
那就先别陷入细节吧，从整体框架入手理解。


## 代码分析-http报文解析


### HTTP_CODE含义
这里可以参考前面的HTTP状态码介绍


### 解析报文整体流程


### 从状态机逻辑


### 主状态机逻辑


# 请求报文响应
概述：解析完之后，跳转do_request函数生成响应报文，通过process_write写入buffer，返回给浏览器端<br>