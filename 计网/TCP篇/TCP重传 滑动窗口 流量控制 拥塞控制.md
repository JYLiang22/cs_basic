- [重传机制](#重传机制)
  - [超时重传](#超时重传)
  - [快速重传](#快速重传)
  - [SACK](#sack)
  - [D-SACK](#d-sack)
- [滑动窗口](#滑动窗口)
- [流量控制](#流量控制)
  - [操作系统缓冲区与滑动窗口的关系](#操作系统缓冲区与滑动窗口的关系)
  - [窗口关闭](#窗口关闭)
  - [糊涂窗口综合症](#糊涂窗口综合症)
- [拥塞控制](#拥塞控制)
  - [慢启动](#慢启动)
  - [拥塞避免](#拥塞避免)
  - [拥塞发生](#拥塞发生)
  - [快速恢复](#快速恢复)


# 重传机制


## 超时重传
1. 超过指定时间，没有收到对方的ack确认应答报文，就会重发数据。
2. 以下两种情况发生超时重传
   - 数据包丢失
   - 确认应答丢失
3. 超时时间应该为多少？
   - RTT(Round-Trip Time)，往返时延，指的是数据发送时刻到接收到确认的时刻的差值
   - 超时重传时间(RTO Retransmission Timeout)应该略大于RTT，如果RTO较长和较短会发生什么？
   - 如果重发的数据再次超时，需要重传的时候，超时间隔就会加倍
   - 所以超时重传 **存在一个问题** ：超时周期相对较长，所以就引出了快速重传


## 快速重传
1. 和上一个的区别：不以时间为驱动，以数据为驱动
2. 工作方式：快速重传的工作方式是当收到三个相同的 ACK 报文时，会在定时器过期之前，重传丢失的报文段。具体可以看博客图
3. **存在问题** ：快速重传机制只解决了一个问题，就是超时时间的问题，但是它依然面临着另外一个问题：有一个数据包丢失的时候，是只重传丢失的那一个，还是重传这个数据包以及之后所有的数据包？所以就引出了SACK方法


## SACK
1. 其实就是我们经常听到的选择性重传(selective Acknowledgment)
2. 这种方式的实现是通过往tcp头部里面加入一个SACK，它可以将已经接收到的数据发送给发送方。具体可以看博客图


## D-SACK
1. 其实就是Duplicate SACK，顾名思义就是告诉发送方有哪些数据被重复接收
2. 文中列了三个作用，具体可以看图，一图胜千言


# 滑动窗口
1. 举了个聊天的例子引出了滑动窗口，生动形象；同时说明了窗口大小的概念以及累计确认/应答
2. TCP里面的window字段，也就是窗口大小，由接收方决定
3. 详细介绍了发送方和接收方的滑动窗口组成和工作原理


# 流量控制
通过一个例子说明了发送方不能一直无脑给接收方发送数据，否则接收方处理不过来导致数据丢失会触发重传。


## 操作系统缓冲区与滑动窗口的关系
1. 实际上，发送窗口和接收窗口中所存放的字节数，都是放在操作系统内存缓冲区中的，而操作系统的缓冲区，会被操作系统调整
2. 举了几个例子说明操作系统是如何调整缓冲区的
   - 第一个例子说明了窗口收缩为0会发生窗口关闭，这个时候发送方会定时发送窗口探测报文
   - 第二个例子说明了不可以先减少缓存再收缩窗口


## 窗口关闭
1. 通过一个例子说明，当发生窗口关闭，接收方处理完数据时，如果返回给发送方的非0ack报文丢失，会发生死锁
2. 通过持续计时器和窗口探测报文解决死锁问题


## 糊涂窗口综合症
1. 一句话总结：传输的有用数据量还比不上传输这个数据量的开销，具体指的是IP+TCP头部
2. 解决方法
   - 让接收方不通告小窗口给发送方
   - 让发送方避免发送小数据
   - 双方具体应该如何操作？


# 拥塞控制
1. 为什么需要拥塞控制？
   - 避免发送方的数据填满整个网络
   - 注意和流量控制的区别
2. 拥塞窗口、发送窗口、接收窗口三者关系
3. 判断网络出现拥塞：发送方没有在规定时间接收到ack应答报文


## 慢启动
1. 含义：一点点提高发送数据包的数量
2. 规则：当发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1
3. 很明显它是指数增长的，所以需要进行控制，引出了拥塞避免算法


## 拥塞避免
1. 规则：每当收到一个 ACK 时，cwnd 增加 1/cwnd
2. 实质：把指数增长变为线性增长


## 拥塞发生
1. 注意区分两种重传机制的工作方式和优缺点
2. 正是因为超时重传缺点明显才有的快速重传


## 快速恢复
具体看博客，现在看完还是有点懵懵的。结合图理解。